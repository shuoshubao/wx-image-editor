(this["webpackJsonpwx-image-editor"]=this["webpackJsonpwx-image-editor"]||[]).push([[0],{124:function(e,t,n){"use strict";n.r(t);var i=n(7),a=n(0),s=n.n(a),r=n(14),c=n.n(r),o=(n(94),n(56)),l=n(46),h=n(47),u=n(58),d=n(57),m=n(75),p=n.n(m),v=n(128),f=n(130),g=n(40),j=n(24),O={size:20,fill:"#fff"},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(j.a)(Object(j.a)({},O),e),n=t.size,a=t.fill;return Object(i.jsx)("svg",{t:"1605843032504",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2822",width:n,height:n,children:Object(i.jsx)("path",{d:"M682.569143 266.221714c25.709714 19.273143 52.297143 11.574857 52.297143-22.308571v-58.697143h1.28c93.001143 0 151.698286 64.292571 151.698285 155.995429 0 56.996571-17.554286 78.445714-18.834285 93.860571-0.438857 11.995429 3.84 19.291429 13.714285 24.009143 13.275429 6.418286 28.708571 0.420571 35.986286-12.013714 13.293714-22.710857 22.710857-60.416 22.710857-106.276572 0-122.569143-81.846857-205.293714-204.854857-205.293714h-1.718857V72.502857c0-34.706286-26.148571-42.422857-52.278857-22.710857L565.577143 135.497143c-19.712 14.573714-19.712 31.286857 0 45.44zM192.713143 993.938286h424.722286c73.270857 0 110.134857-35.145143 110.134857-110.153143v-423.862857c0-74.989714-36.864-110.134857-110.134857-110.134857H192.713143c-73.289143 0-110.134857 35.145143-110.134857 110.134857v423.862857c0 75.008 36.845714 110.153143 110.134857 110.153143z m1.28-69.010286c-29.129143 0-42.422857-11.995429-42.422857-42.422857v-421.302857c0-30.409143 13.293714-42.422857 42.422857-42.422857h422.144c29.568 0 42.422857 12.013714 42.422857 42.422857v421.302857c0 30.427429-12.854857 42.422857-42.422857 42.422857z","p-id":"2823",fill:a})})},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(j.a)(Object(j.a)({},O),e),n=t.size,a=t.fill;return Object(i.jsx)("svg",{t:"1605843505098",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"969",width:n,height:n,children:Object(i.jsx)("path",{d:"M448 864a32 32 0 0 1-18.88-6.08l-320-234.24a32 32 0 1 1 37.76-51.52l292.16 213.44 397.76-642.56a32 32 0 0 1 54.4 33.92l-416 672a32 32 0 0 1-21.12 14.4L448 864z","p-id":"970",fill:a})})},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(j.a)(Object(j.a)({},O),e),n=t.size,a=t.fill;return Object(i.jsx)("svg",{t:"1605843652172",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1154",width:n,height:n,children:Object(i.jsx)("path",{d:"M810.666667 273.493333L750.506667 213.333333 512 451.84 273.493333 213.333333 213.333333 273.493333 451.84 512 213.333333 750.506667 273.493333 810.666667 512 572.16 750.506667 810.666667 810.666667 750.506667 572.16 512z","p-id":"1155",fill:a})})},y=n(31),C=n.n(y),k=n(59),M=n(76),E=n.n(M),_=n(77),R=n.n(_),D=n(63),I=function(e,t,n,i,a,s,r,c,o,l,h,u,d,m,p,v){this.elements=window.Float32Array?new Float32Array(16):[];var f=this.elements;f[0]=void 0!==e?e:1,f[4]=t||0,f[8]=n||0,f[12]=i||0,f[1]=a||0,f[5]=void 0!==s?s:1,f[9]=r||0,f[13]=c||0,f[2]=o||0,f[6]=l||0,f[10]=void 0!==h?h:1,f[14]=u||0,f[3]=d||0,f[7]=m||0,f[11]=p||0,f[15]=void 0!==v?v:1};function T(e,t,n){for(var i=0,a=t.length;i<a;i++){X(e,t[i],n)}}function X(e,t,n){Object.defineProperty(e,t,{get:function(){return this["__"+t]},set:function(e){e!==this["__"+t]&&(this["__"+t]=e,n())}})}I.DEG_TO_RAD=Math.PI/180,I.prototype={set:function(e,t,n,i,a,s,r,c,o,l,h,u,d,m,p,v){var f=this.elements;return f[0]=e,f[4]=t,f[8]=n,f[12]=i,f[1]=a,f[5]=s,f[9]=r,f[13]=c,f[2]=o,f[6]=l,f[10]=h,f[14]=u,f[3]=d,f[7]=m,f[11]=p,f[15]=v,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},multiplyMatrices:function(e,t){var n=e.elements,i=this.elements,a=n[0],s=n[4],r=n[8],c=n[12],o=n[1],l=n[5],h=n[9],u=n[13],d=n[2],m=n[6],p=n[10],v=n[14],f=n[3],g=n[7],j=n[11],O=n[15],b=t[0],w=t[1],x=t[2],y=t[3],C=t[4],k=t[5],M=t[6],E=t[7],_=t[8],R=t[9],D=t[10],I=t[11],T=t[12],X=t[13],Y=t[14],N=t[15];return i[0]=a*b+s*C+r*_+c*T,i[4]=a*w+s*k+r*R+c*X,i[8]=a*x+s*M+r*D+c*Y,i[12]=a*y+s*E+r*I+c*N,i[1]=o*b+l*C+h*_+u*T,i[5]=o*w+l*k+h*R+u*X,i[9]=o*x+l*M+h*D+u*Y,i[13]=o*y+l*E+h*I+u*N,i[2]=d*b+m*C+p*_+v*T,i[6]=d*w+m*k+p*R+v*X,i[10]=d*x+m*M+p*D+v*Y,i[14]=d*y+m*E+p*I+v*N,i[3]=f*b+g*C+j*_+O*T,i[7]=f*w+g*k+j*R+O*X,i[11]=f*x+g*M+j*D+O*Y,i[15]=f*y+g*E+j*I+O*N,this},_rounded:function(e,t){return t=Math.pow(10,t||15),Math.round(e*t)/t},appendTransform:function(e,t,n,i,a,s,r,c,o,l,h,u,d,m){var p=r*I.DEG_TO_RAD,v=this._rounded(Math.cos(p)),f=this._rounded(Math.sin(p)),g=c*I.DEG_TO_RAD,j=this._rounded(Math.cos(g)),O=this._rounded(Math.sin(g)),b=o*I.DEG_TO_RAD,w=this._rounded(Math.cos(-1*b)),x=this._rounded(Math.sin(-1*b));return this.multiplyMatrices(this,[1,0,0,e,0,v,f,t,0,-f,v,n,0,0,0,1]),this.multiplyMatrices(this,[j,0,O,0,0,1,0,0,-O,0,j,0,0,0,0,1]),this.multiplyMatrices(this,[w*i,x*a,0,0,-x*i,w*a,0,0,0,0,1*s,0,0,0,0,1]),(l||h)&&this.multiplyMatrices(this,[this._rounded(Math.cos(l*I.DEG_TO_RAD)),this._rounded(Math.sin(l*I.DEG_TO_RAD)),0,0,-1*this._rounded(Math.sin(h*I.DEG_TO_RAD)),this._rounded(Math.cos(h*I.DEG_TO_RAD)),0,0,0,0,1,0,0,0,0,1]),(u||d||m)&&(this.elements[12]-=u*this.elements[0]+d*this.elements[4]+m*this.elements[8],this.elements[13]-=u*this.elements[1]+d*this.elements[5]+m*this.elements[9],this.elements[14]-=u*this.elements[2]+d*this.elements[6]+m*this.elements[10]),this}};n(97);var Y=function(e,t){return new Promise((function(n){e.setState(t,n)}))},N=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(l.a)(this,n),(i=t.call(this,e)).state={imageUrl:"",isCapturing:!1},i.imageRef=s.a.createRef(),i.containerRef=s.a.createRef(),i.captureContainerRef=s.a.createRef(),i.imageInstance=null,i.domEvents=i.getDomEvents(),i.customEvents=i.getCustomEvents(),i}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(k.a)(C.a.mark((function e(){var t,n,i,a=this;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.value,e.next=3,this.customEvents.getImgaeInfo(t);case 3:n=e.sent,i=n.url,this.setState({imageUrl:i},(function(){a.customEvents.initAlloyFingerImage()}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDomEvents",value:function(){return{}}},{key:"getCustomEvents",value:function(){var e=this;return{getImgaeInfo:function(t){if(t.startsWith("data:image")){var n=e.props,i=n.width,a=n.height;return{url:t,width:i,height:a}}return new Promise((function(e){var n=new Image;n.setAttribute("crossorigin","anonymous"),n.src=t,n.onload=function(){var t=document.createElement("canvas"),i=n.width,a=n.height;t.width=i,t.height=a,t.getContext("2d").drawImage(n,0,0,i,a);var s=t.toDataURL("image/jpeg");e({url:s,width:i,height:a})}}))},initAlloyFingerImage:function(){var t=e.imageRef.current;!function(e){T(e,["translateX","translateY","translateZ","scaleX","scaleY","scaleZ","rotateX","rotateY","rotateZ","skewX","skewY","originX","originY","originZ"],(function(){var t=e.matrix3D.identity().appendTransform(e.translateX,e.translateY,e.translateZ,e.scaleX,e.scaleY,e.scaleZ,e.rotateX,e.rotateY,e.rotateZ,e.skewX,e.skewY,e.originX,e.originY,e.originZ);e.style.transform=e.style.msTransform=e.style.OTransform=e.style.MozTransform=e.style.webkitTransform="perspective("+e.perspective+"px) matrix3d("+Array.prototype.slice.call(t.elements).join(",")+")"})),T(e,["perspective"],(function(){e.style.transform=e.style.msTransform=e.style.OTransform=e.style.MozTransform=e.style.webkitTransform="perspective("+e.perspective+"px) matrix3d("+Array.prototype.slice.call(e.matrix3D.elements).join(",")+")"})),e.matrix3D=new I,e.perspective=500,e.scaleX=e.scaleY=e.scaleZ=1,e.translateX=e.translateY=e.translateZ=e.rotateX=e.rotateY=e.rotateZ=e.skewX=e.skewY=e.originX=e.originY=e.originZ=0}(t);var n=1;new R.a(t,{multipointStart:function(){n=t.scaleX},pinch:function(e){t.scaleX=n*e.zoom,t.scaleY=n*e.zoom},pressMove:function(e){t.translateX+=e.deltaX,t.translateY+=e.deltaY,e.preventDefault()}}),e.imageInstance=t},handleOk:function(){var t=Object(k.a)(C.a.mark((function t(){var n;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.customEvents.getCaptureData();case 2:n=t.sent,e.props.onOk&&e.props.onOk(n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),handleCancel:function(){e.props.onCancel&&e.props.onCancel()},handleRotateLeft:function(){e.imageInstance.rotateZ-=90},handleReset:function(){e.imageInstance.rotateZ=0,e.imageInstance.translateX=0,e.imageInstance.translateY=0},getCutContainerStyle:function(){var t=e.props;return{width:t.width,height:t.height}},getCaptureData:function(){var t=Object(k.a)(C.a.mark((function t(){var n,i,a,s,r,c,l;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.scrollingElement.scrollTop=0,n=e.containerRef.current,i=e.captureContainerRef.current,a=i.getClientRects(),s=Object(o.a)(a,1),r=s[0],t.next=6,Y(e,{isCapturing:!0});case 6:return t.next=8,E()(n,Object(j.a)({useCORS:!0,logging:!1,scale:1,allowTaint:!1,foreignObjectRendering:!1},Object(D.pick)(r,["x","y","width","height"])));case 8:return c=t.sent,l=c.toDataURL("image/jpg"),e.setState({isCapturing:!1}),t.abrupt("return",l);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}},{key:"render",value:function(){var e=this.state,t=this.customEvents,n=e.isCapturing,a=e.imageUrl;return Object(i.jsxs)("div",{className:"modal-image-editor",children:[Object(i.jsx)("div",{className:"mask"}),Object(i.jsxs)("div",{className:Object(g.classNames)("wrap",{"is-capturing":n}),ref:this.containerRef,children:[Object(i.jsxs)("div",{className:"content",children:[Object(i.jsx)("div",{className:"image-handler",children:Object(i.jsx)("div",{className:"image-handler-wrap",children:Object(i.jsx)("img",{ref:this.imageRef,src:a,alt:""})})}),Object(i.jsxs)("div",{ref:this.captureContainerRef,className:"container-cut",style:t.getCutContainerStyle(),children:[Object(i.jsx)("div",{className:"dashed dashed-h"}),Object(i.jsx)("div",{className:"dashed dashed-v"})]})]}),Object(i.jsxs)("div",{className:"footer",children:[Object(i.jsx)("span",{className:"icon icon-close",onClick:t.handleCancel,children:Object(i.jsx)(x,{})}),Object(i.jsx)("span",{className:"text-reset",onClick:t.handleReset,children:"\u8fd8\u539f"}),Object(i.jsx)("span",{className:"icon icon-confirm",onClick:t.handleOk,children:Object(i.jsx)(w,{})}),Object(i.jsx)("span",{className:"icon icon-rotate",onClick:t.handleRotateLeft,children:Object(i.jsx)(b,{})})]})]})]})}}]),n}(s.a.Component);N.defaultProps={width:100,height:100};n(98);var A=n.p+"static/media/demo.9e814f25.jpeg";new p.a;var z=A,S=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var i;return Object(l.a)(this,n),(i=t.call(this,e)).state={previewImageUrl:z,visibileModal:!1},i.elementInputFile=null,i.domEvents=i.getDomEvents(),i.customEvents=i.getCustomEvents(),i}return Object(h.a)(n,[{key:"componentWillUnmount",value:function(){document.body.removeChild(this.elementInputFile)}},{key:"getDomEvents",value:function(){var e=this;return{handleChangeImage:function(){if(e.elementInputFile)e.elementInputFile.click();else{var t=e.customEvents,n=document.createElement("input");Object(g.setStyle)(n,{visibility:"hidden"}),Object(g.setAttrs)(n,{type:"file",name:"shuoshubao-test",accept:".png, .jpg, .jpeg"}),document.body.appendChild(n),n.addEventListener("change",t.changeImageListener,!1),n.click(),e.elementInputFile=n}}}}},{key:"getCustomEvents",value:function(){var e=this;return{changeImageListener:function(t){var n=Object(o.a)(t.target.files,1)[0],i=(n.name,n.size,n.type,(window.URL||window.webkitURL).createObjectURL(n));e.setState({previewImageUrl:i},(function(){e.customEvents.showModal()}))},showModal:function(){e.setState({visibileModal:!0})},handleOk:function(t){e.setState({visibileModal:!1}),e.setState({previewImageUrl:t})},handleCancel:function(){e.setState({visibileModal:!1})}}}},{key:"render",value:function(){var e=this.state,t=this.domEvents,n=this.customEvents,a=e.previewImageUrl,s=e.visibileModal;return Object(i.jsxs)("div",{className:"app-container",children:[Object(i.jsxs)(v.a,{title:"Card title",bordered:!1,style:{width:300},children:[Object(i.jsx)(f.a,{type:"primary",onClick:function(){t.handleChangeImage()},children:"\u66f4\u6362\u7167\u7247"}),Object(i.jsx)("div",{onClick:n.showModal,children:Object(i.jsx)("img",{src:a,className:"preview-image"})})]}),s&&Object(i.jsx)(N,{value:a,width:300,height:300,onOk:n.handleOk,onCancel:n.handleCancel})]})}}]),n}(s.a.Component);c.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(S,{})}),document.getElementById("root"))},97:function(e,t,n){},98:function(e,t,n){}},[[124,1,2]]]);
//# sourceMappingURL=main.b598cb68.chunk.js.map